# 开发计划与优先级

## 📋 概述

本文档规划 WinsRehab 应用的开发计划，按功能优先级划分开发阶段，确保核心功能优先实现，逐步完善应用。

---

## 🎯 开发原则

### 核心原则
1. **MVP 优先**：先实现最小可行产品，打通核心业务流程
2. **迭代开发**：分阶段开发，每个阶段都有可交付的成果
3. **用户价值**：优先开发对用户价值最大的功能
4. **技术可行**：优先实现技术难度较低的功能

### 质量标准
- 每个功能开发完成后必须经过测试
- 代码遵循 MVVM 架构规范
- UI 符合设计规范
- 性能满足流畅使用要求

---

## 📅 开发阶段规划

### 第一阶段：核心闭环（MVP）

**目标**：实现医患协作的核心业务流程，打通从计划制定到视频审核的完整闭环。

**预计时间**：7-10 天

#### 功能清单

**1. 用户系统（2天）**
- ✅ 医生注册与登录
- ✅ 患者注册与登录
- ✅ 医患绑定流程
  - 患者输入医生工号
  - 医生确认接收患者
  - 绑定状态管理
- ✅ 基本信息管理
  - 医生信息查看与编辑
  - 患者信息查看与编辑

**2. 数据库重构（2天）**
- ✅ 创建新的 Entity 类
  - RehabPlan
  - TrainingTask
  - TaskInstance
  - TrainingVideo
- ✅ 编写 DAO 接口
- ✅ 编写 Migration 脚本（版本4→5）
- ✅ 测试数据库迁移
- ✅ 初始化测试数据

**3. 康复计划制定（2天）**
- ✅ 医生端：创建康复计划
  - 填写计划基本信息
  - 添加训练任务
  - 设置任务频率规则
  - 保存草稿 / 激活计划
- ✅ 医生端：查看计划列表
- ✅ 患者端：查看我的康复计划
  - 计划基本信息
  - 任务列表
  - 完成情况

**4. 任务执行与视频上传（2-3天）**
- ✅ 系统：任务生成逻辑
  - 患者登录时生成今日任务
  - 根据频率规则判断
- ✅ 患者端：今日任务列表
  - 显示所有今日任务
  - 任务状态标识
- ✅ 患者端：视频录制
  - 调用相机录制视频
  - 视频预览
  - 添加文字说明
  - 保存到本地存储
- ✅ 患者端：视频上传
  - 创建视频记录
  - 关联任务实例
  - 更新任务状态

**5. 视频审核（2天）**
- ✅ 医生端：待审核视频列表
  - 显示所有待审核视频
  - 按优先级排序
- ✅ 医生端：视频审核页面
  - 播放视频
  - 查看患者说明
  - 填写审核意见
  - 提交审核
- ✅ 患者端：查看审核结果
  - 视频列表
  - 审核状态
  - 医生点评

**6. 基础统计（1天）**
- ✅ 患者端：康复数据统计
  - 康复天数
  - 今日任务完成情况
  - 本周完成率
- ✅ 医生端：工作统计
  - 管理患者数
  - 待审核视频数
  - 待处理反馈数

#### 验收标准
- 医生可以为患者制定康复计划
- 患者可以看到今日任务并录制视频
- 医生可以审核视频并给出点评
- 患者可以查看审核结果
- 基础统计数据正确显示

---

### 第二阶段：反馈与调整

**目标**：完善医患互动功能，支持反馈沟通和计划调整。

**预计时间**：5-7 天

#### 功能清单

**1. 患者反馈功能（2天）**
- ✅ 患者端：发送反馈
  - 选择反馈类型
  - 填写反馈内容
  - 设置优先级
- ✅ 医生端：反馈列表
  - 显示所有反馈
  - 按优先级和状态筛选
- ✅ 医生端：回复反馈
  - 查看反馈详情
  - 填写回复内容
  - 提交回复
- ✅ 患者端：查看医生回复
  - 反馈列表
  - 反馈详情
  - 历史对话

**2. 计划调整功能（2天）**
- ✅ 医生端：调整康复计划
  - 添加新任务
  - 修改现有任务
  - 删除任务
  - 修改计划周期
- ✅ 系统：调整记录保存
  - 创建调整记录
  - 记录调整原因
- ✅ 患者端：查看调整记录
  - 显示调整历史
  - 调整内容说明

**3. 通知系统（2天）**
- ✅ 本地通知实现
  - 使用 NotificationManager
  - 通知样式设计
- ✅ 医生端通知
  - 新患者申请
  - 新视频待审核
  - 新反馈待回复
- ✅ 患者端通知
  - 医生确认绑定
  - 视频审核完成
  - 医生回复反馈
  - 计划调整
- ✅ 通知点击跳转
  - 跳转到对应页面
  - 传递相关参数

**4. 进度可视化优化（1天）**
- ✅ 患者端：本周完成情况柱状图
- ✅ 患者端：康复进度曲线图（可选）
- ✅ 医生端：患者进度对比图（可选）

#### 验收标准
- 患者可以发送反馈，医生可以回复
- 医生可以调整康复计划，患者可以看到调整
- 通知功能正常工作，点击可以跳转
- 进度数据可视化清晰

---

### 第三阶段：辅助功能

**目标**：添加辅助功能，提升用户体验和应用价值。

**预计时间**：5-7 天

#### 功能清单

**1. 心理助手（AI 聊天）（2天）**
- ✅ 聊天界面实现
  - 消息列表
  - 输入框
  - 发送按钮
- ✅ AI 对话功能
  - 集成 DeepSeek API（已完成）
  - 优化 Prompt 设计
  - 聊天记录保存
- ✅ 预设问题（可选）
  - 常见问题列表
  - 点击发送

**2. 示范视频库（2天）**
- ✅ 视频库首页
  - 视频列表
  - 分类筛选
  - 难度筛选
- ✅ 视频播放页面
  - 全屏播放
  - 视频信息展示
- ✅ 收藏功能
  - 收藏视频
  - 我的收藏列表
- ✅ 初始化示范视频数据

**3. 医生工作台优化（1-2天）**
- ✅ 今日任务列表
  - 待审核视频
  - 待回复反馈
  - 待随访患者（可选）
- ✅ 任务优先级排序
- ✅ 快捷操作入口
- ✅ 数据统计卡片

**4. 患者主页优化（1天）**
- ✅ 欢迎卡片优化
  - 动态问候语
  - 康复天数提示
- ✅ 今日任务卡片
  - 任务状态可视化
  - 快捷操作按钮
- ✅ 功能卡片网格
  - 心理助手
  - 训练视频库
  - 病友社区（入口）
  - 医生反馈

**5. 搜索功能（1天）**
- ✅ 医生端：搜索患者
  - 按姓名搜索
  - 按诊断搜索
- ✅ 患者端：搜索视频
  - 按标题搜索
  - 搜索历史

#### 验收标准
- AI 聊天功能正常，回复合理
- 示范视频库可以浏览和播放
- 医生工作台清晰展示待办事项
- 患者主页信息丰富，操作便捷
- 搜索功能快速准确

---

### 第四阶段：社区功能

**目标**：构建病友社区，增强用户粘性和互动。

**预计时间**：5-7 天

#### 功能清单

**1. 病友社区基础（3天）**
- ✅ 社区首页
  - 帖子列表
  - 标签切换（最新/热门）
- ✅ 发布帖子
  - 填写标题和内容
  - 匿名选项
- ✅ 帖子详情页
  - 完整内容展示
  - 点赞功能
  - 评论列表
- ✅ 发表评论
  - 评论输入
  - 回复评论
- ✅ 我的帖子
  - 查看自己的帖子
  - 删除帖子

**2. 每周排行榜（2天）**
- ✅ 排行榜页面
  - 显示本周排名
  - 前三名特殊展示
  - 自己的排名高亮
- ✅ 排行榜生成逻辑
  - 定时任务（每周一凌晨）
  - 计算完成率
  - 排序和排名
- ✅ 隐私设置
  - 选择是否参与排行榜
  - 昵称设置

**3. 社区互动优化（1-2天）**
- ✅ 点赞动画
- ✅ 评论通知（可选）
- ✅ 热门帖子推荐（可选）
- ✅ 帖子分享（可选）

#### 验收标准
- 患者可以发帖、评论、点赞
- 排行榜每周自动更新
- 隐私设置生效
- 社区互动流畅

---

### 第五阶段：优化与完善

**目标**：优化性能、完善细节、提升用户体验。

**预计时间**：5-7 天

#### 功能清单

**1. 性能优化（2天）**
- ✅ 数据库查询优化
  - 添加必要的索引
  - 优化复杂查询
- ✅ 列表分页加载
  - 患者列表
  - 帖子列表
  - 视频列表
- ✅ 图片缓存优化
  - 使用 Glide 缓存头像和缩略图
- ✅ 内存优化
  - 及时释放资源
  - 避免内存泄漏

**2. UI/UX 优化（2天）**
- ✅ 加载动画
  - 数据加载时显示骨架屏
  - 网络请求显示 Loading
- ✅ 空状态处理
  - 无患者时的提示
  - 无任务时的提示
  - 无视频时的提示
- ✅ 错误提示优化
  - 友好的错误信息
  - 操作失败的重试按钮
- ✅ 动画效果
  - 页面切换动画
  - 按钮点击反馈
  - 列表项动画

**3. 数据验证与安全（1天）**
- ✅ 输入验证
  - 手机号格式验证
  - 密码强度验证
  - 年龄范围验证
- ✅ 密码加密
  - 使用 SHA-256 加密存储
- ✅ API Key 保护
  - 移到 local.properties

**4. 测试与修复（2天）**
- ✅ 功能测试
  - 测试所有核心功能
  - 测试边界情况
- ✅ 兼容性测试
  - 不同 Android 版本
  - 不同屏幕尺寸
- ✅ Bug 修复
  - 修复测试中发现的问题
- ✅ 性能测试
  - 测试应用流畅度
  - 测试内存占用

#### 验收标准
- 应用运行流畅，无明显卡顿
- 列表加载快速，支持分页
- UI 美观，交互友好
- 数据安全，输入验证完善
- 主要功能无 Bug

---

### 第六阶段：高级功能（可选）

**目标**：添加高级功能，提升应用竞争力。

**预计时间**：根据需求确定

#### 功能清单

**1. 云存储支持**
- 视频上传到云存储（阿里云 OSS / 七牛云）
- 多端同步
- 断点续传

**2. 数据导出**
- 导出康复报告（PDF）
- 导出训练记录（Excel）
- 数据备份与恢复

**3. 高级统计分析**
- 康复效果分析
- 训练强度分析
- 医生工作效率分析
- 数据可视化图表

**4. 多语言支持**
- 中文 / 英文切换
- 国际化资源文件

**5. 推送通知**
- 集成 Firebase Cloud Messaging
- 远程推送通知
- 通知管理

**6. 视频通话（可选）**
- 医生与患者视频通话
- 远程指导训练

---

## 📊 开发进度跟踪

### 进度表格

| 阶段 | 功能模块 | 预计时间 | 优先级 | 状态 |
|------|---------|---------|--------|------|
| 第一阶段 | 用户系统 | 2天 | 🔴 最高 | 待开始 |
| 第一阶段 | 数据库重构 | 2天 | 🔴 最高 | 待开始 |
| 第一阶段 | 康复计划制定 | 2天 | 🔴 最高 | 待开始 |
| 第一阶段 | 任务执行与视频上传 | 2-3天 | 🔴 最高 | 待开始 |
| 第一阶段 | 视频审核 | 2天 | 🔴 最高 | 待开始 |
| 第一阶段 | 基础统计 | 1天 | 🔴 最高 | 待开始 |
| 第二阶段 | 患者反馈功能 | 2天 | 🟡 高 | 待开始 |
| 第二阶段 | 计划调整功能 | 2天 | 🟡 高 | 待开始 |
| 第二阶段 | 通知系统 | 2天 | 🟡 高 | 待开始 |
| 第二阶段 | 进度可视化优化 | 1天 | 🟡 高 | 待开始 |
| 第三阶段 | 心理助手 | 2天 | 🟢 中 | 待开始 |
| 第三阶段 | 示范视频库 | 2天 | 🟢 中 | 待开始 |
| 第三阶段 | 医生工作台优化 | 1-2天 | 🟢 中 | 待开始 |
| 第三阶段 | 患者主页优化 | 1天 | 🟢 中 | 待开始 |
| 第三阶段 | 搜索功能 | 1天 | 🟢 中 | 待开始 |
| 第四阶段 | 病友社区基础 | 3天 | 🟢 中 | 待开始 |
| 第四阶段 | 每周排行榜 | 2天 | 🟢 中 | 待开始 |
| 第四阶段 | 社区互动优化 | 1-2天 | 🔵 低 | 待开始 |
| 第五阶段 | 性能优化 | 2天 | 🟡 高 | 待开始 |
| 第五阶段 | UI/UX 优化 | 2天 | 🟡 高 | 待开始 |
| 第五阶段 | 数据验证与安全 | 1天 | 🟡 高 | 待开始 |
| 第五阶段 | 测试与修复 | 2天 | 🟡 高 | 待开始 |

### 里程碑

**里程碑 1：MVP 完成**
- 时间：第一阶段结束
- 标志：核心业务流程打通，可以进行基本的康复管理

**里程碑 2：功能完善**
- 时间：第二阶段结束
- 标志：医患互动功能完善，支持反馈和计划调整

**里程碑 3：体验提升**
- 时间：第三阶段结束
- 标志：辅助功能完善，用户体验良好

**里程碑 4：社区上线**
- 时间：第四阶段结束
- 标志：病友社区功能完整，用户可以互动

**里程碑 5：正式发布**
- 时间：第五阶段结束
- 标志：应用稳定、性能良好，可以正式发布

---

## 🎯 开发建议

### 开发顺序建议
1. **先数据库，后功能**：先完成数据库重构，再开发上层功能
2. **先医生端，后患者端**：医生端是管理核心，先实现医生端功能
3. **先核心，后辅助**：先实现核心业务流程，再添加辅助功能
4. **先功能，后优化**：先实现功能，再优化性能和体验

### 技术实现建议
1. **使用 Git 版本控制**：每个功能模块一个分支，完成后合并
2. **编写清晰的注释**：方便后期维护和团队协作
3. **遵循命名规范**：统一的命名风格，提高代码可读性
4. **及时测试**：每完成一个功能就测试，避免积累问题
5. **代码复用**：提取公共组件和工具类，避免重复代码

### 团队协作建议
1. **每日站会**：同步进度，讨论问题
2. **代码审查**：互相审查代码，保证质量
3. **文档更新**：及时更新设计文档和接口文档
4. **问题记录**：使用 Issue 跟踪问题和需求

---

## 📝 开发检查清单

### 功能开发检查
- [ ] 功能需求明确
- [ ] 数据库设计完成
- [ ] DAO 接口实现
- [ ] Repository 层实现
- [ ] ViewModel 层实现
- [ ] UI 界面实现
- [ ] 数据绑定完成
- [ ] 交互逻辑实现
- [ ] 异常处理完善
- [ ] 功能测试通过

### 代码质量检查
- [ ] 代码符合 MVVM 架构
- [ ] 命名规范统一
- [ ] 注释清晰完整
- [ ] 无明显性能问题
- [ ] 无内存泄漏
- [ ] 无编译警告
- [ ] 通过 Lint 检查

### UI/UX 检查
- [ ] UI 符合设计规范
- [ ] 交互流畅自然
- [ ] 加载状态清晰
- [ ] 错误提示友好
- [ ] 空状态处理完善
- [ ] 适配不同屏幕尺寸

### 测试检查
- [ ] 功能测试通过
- [ ] 边界情况测试
- [ ] 异常情况测试
- [ ] 兼容性测试
- [ ] 性能测试通过

---

## 🚀 发布计划

### 内测版本（v0.1）
- 时间：第一阶段完成后
- 范围：核心功能
- 用户：内部测试

### 公测版本（v0.5）
- 时间：第三阶段完成后
- 范围：核心功能 + 辅助功能
- 用户：小范围公测

### 正式版本（v1.0）
- 时间：第五阶段完成后
- 范围：所有基础功能
- 用户：正式发布

### 后续版本
- v1.1：社区功能优化
- v1.2：高级统计功能
- v2.0：云存储支持

---

**文档结束**





