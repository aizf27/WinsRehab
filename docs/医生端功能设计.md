# 医生端功能设计文档

## 📋 概述

医生端是 WinsRehab 应用的管理核心，医生通过该端口管理患者、制定康复计划、审核训练视频、处理患者反馈，实现对患者康复过程的全程监控和指导。

---

## 🏠 模块一：医生工作台（主页）

### 功能定位
医生工作台是医生登录后的首页，提供工作概览和快捷入口，帮助医生快速了解当前工作状态并进入相关功能。

### 核心功能

#### 1. 欢迎卡片
**展示内容**：
- 问候语（根据时间显示：早上好/中午好/下午好/晚上好）
- 医生姓名和职称
- 今日工作简报（如"今天有 3 个待审核视频，2 条患者反馈"）

**数据统计**：
- 管理患者总数
- 待审核视频数量
- 待处理反馈数量

#### 2. 核心功能卡片
四个主要功能入口，采用卡片式设计：

**管理患者**
- 图标：用户组图标（蓝色）
- 显示：当前管理的患者数量
- 点击：跳转到患者管理页面

**审核视频**
- 图标：播放图标（紫色）
- 显示：待审核视频数量
- 角标：如有紧急视频显示红色数字
- 点击：跳转到视频审核页面

**制定计划**
- 图标：日程图标（绿色）
- 显示：待制定计划的患者数量
- 点击：跳转到计划制定页面

**患者反馈**
- 图标：消息图标（橙色）
- 显示：未读反馈数量
- 角标：如有紧急反馈显示红色数字
- 点击：跳转到反馈处理页面

#### 3. 今日任务列表
展示医生今天需要处理的任务，按优先级排序：

**任务类型**：
- 紧急任务（红色左边框）：如患者反馈疼痛加剧、紧急视频待审核
- 普通任务（蓝色左边框）：如定期随访、常规视频审核

**任务信息**：
- 时间标记（如"30分钟前"、"14:00"）
- 患者姓名
- 任务描述
- 操作按钮（处理/查看/开始）

**交互**：
- 点击任务：跳转到对应的处理页面
- 完成任务：任务从列表中移除或标记为已完成

#### 4. 顶部工具栏
- 搜索框：快速搜索患者、病历
- 通知图标：显示未读通知数量（红点）
- 切换账户：退出登录或切换账户

### UI 对应
`fragment_dt_home.xml`

---

## 👥 模块二：患者管理

### 功能定位
患者管理是医生的核心工作模块，医生可以查看所有管理的患者，了解患者的康复状态，并进行相应的操作。

### 核心功能

#### 1. 数据概览
顶部四个统计卡片，快速了解整体情况：
- **总患者数**：当前管理的患者总数
- **待审核**：有待审核视频的患者数量
- **新反馈**：有新反馈的患者数量
- **待制定**：需要制定或调整计划的患者数量

#### 2. 标签切换
三个标签页，方便医生分类查看：
- **全部患者**：显示所有管理的患者
- **待审核视频**：筛选出有待审核视频的患者
- **患者反馈**：筛选出有新反馈的患者

#### 3. 患者列表
每个患者以卡片形式展示：

**基本信息**：
- 头像（圆形，带颜色背景）
- 姓名 + 年龄
- 诊断信息（如"脑卒中康复"）
- 最后活跃时间（如"2小时前"）

**康复状态**：
- 康复进度条（显示百分比）
- 进度数值（如"85%"）

**待处理事项徽章**：
- 紫色徽章：显示待审核视频数量（如"2个新视频"）
- 橙色徽章：显示新反馈数量（如"1条新反馈"）

**操作按钮**：
- 查看计划：查看患者的康复计划
- 审核视频：直接进入该患者的视频审核
- 回复反馈：查看并回复患者反馈

**交互**：
- 点击患者卡片：进入患者详情页
- 点击操作按钮：跳转到对应功能页面

#### 4. 搜索与筛选
- **搜索框**：支持按患者姓名、诊断信息搜索
- **筛选按钮**：按康复阶段、进度范围、活跃度筛选

#### 5. 患者详情页
点击患者卡片后进入，展示患者的完整信息：

**个人信息**：
- 基本信息：姓名、性别、年龄、联系方式
- 医疗信息：诊断、康复阶段、康复中心

**康复数据**：
- 康复天数
- 总体进度
- 本周完成率
- 今日任务完成情况

**康复计划**：
- 当前活跃的康复计划列表
- 每个计划的进度和状态
- 点击计划：查看计划详情

**训练记录**：
- 历史训练记录列表
- 每条记录显示：日期、任务名称、完成状态、医生点评

**视频记录**：
- 患者上传的所有视频
- 显示：缩略图、标题、上传时间、审核状态
- 点击视频：播放并查看审核记录

**反馈记录**：
- 患者的所有反馈
- 显示：反馈内容、时间、医生回复、状态

**操作入口**：
- 制定新计划
- 调整现有计划
- 查看待审核视频
- 回复反馈

#### 6. 新患者申请
当有患者申请绑定时：
- 医生端收到通知
- 在患者管理页面顶部显示"新患者申请"横幅
- 点击查看申请详情：患者姓名、账号、申请时间
- 操作：确认接收 / 拒绝申请
- 确认后：患者正式加入医生的管理列表

### UI 对应
`fragment_dt_pt_manage.xml`

---

## 📋 模块三：康复计划制定

### 功能定位
医生根据患者的病情和康复目标，制定个性化的康复计划，包含多个训练任务和执行规则。

### 核心功能

#### 1. 创建康复计划
**基本信息填写**：
- 计划名称（如"脑卒中上肢康复计划"）
- 康复目标（如"恢复上肢功能，提升日常生活能力"）
- 计划周期：开始日期、结束日期
- 选择患者：从管理的患者列表中选择

#### 2. 添加训练任务
每个计划包含多个训练任务，每个任务需要设置：

**任务基本信息**：
- 任务名称（如"上肢功能训练"）
- 任务类型（上肢/下肢/全身/平衡/协调）
- 任务描述（详细说明训练内容和注意事项）

**执行规则**：
- 建议时长（如30分钟）
- 执行频率：
  - 每天执行
  - 每周特定天（如周一、周三、周五）
  - 间隔天数（如每隔2天）
- 优先级（普通/重要）

**参考视频**：
- 可以从示范视频库中选择参考视频
- 患者可以在执行任务时查看参考视频

#### 3. 任务列表管理
- 显示已添加的所有任务
- 支持拖拽排序（调整任务顺序）
- 支持编辑任务
- 支持删除任务

#### 4. 计划预览
提交前预览整个计划：
- 计划基本信息
- 任务列表及执行规则
- 预计生成的每日任务示例（如"第一周每天的任务安排"）

#### 5. 保存与激活
- **保存为草稿**：计划保存但不激活，可以继续编辑
- **激活计划**：计划正式生效，系统开始为患者生成每日任务
- 激活后患者端立即可见该计划

#### 6. 计划调整
对于已激活的计划，医生可以进行调整：

**调整方式**：
- 添加新任务
- 修改现有任务（时长、频率）
- 删除任务
- 修改计划周期

**调整记录**：
- 系统记录每次调整的时间和内容
- 患者可以查看调整历史
- 旧的任务实例保留，新任务从调整日期开始生效

**调整通知**：
- 调整后患者端收到通知
- 通知内容：医生调整了您的康复计划，请查看

#### 7. 计划模板（可选功能）
为了提高效率，医生可以创建计划模板：
- 保存常用的计划配置
- 为新患者快速应用模板
- 模板可以根据患者情况微调

### 业务逻辑

#### 任务生成机制
- 医生创建计划时，定义的是"任务模板"（TrainingTask）
- 系统根据模板的频率规则，为患者生成"任务实例"（TaskInstance）
- 生成时机：患者登录时动态生成今日任务

**示例**：
```
任务模板：上肢功能训练
- 频率：每天1次
- 时长：30分钟

系统生成任务实例：
- 2024-01-15：上肢功能训练（待完成）
- 2024-01-16：上肢功能训练（待完成）
- 2024-01-17：上肢功能训练（已完成）
```

#### 多计划支持
- 一个患者可以同时有多个活跃计划
- 例如：上肢康复计划 + 下肢康复计划
- 每日任务是所有活跃计划的任务实例的合集

---

## 🎥 模块四：视频审核

### 功能定位
医生审核患者上传的康复训练视频，给出专业点评和建议，帮助患者改进训练效果。

### 核心功能

#### 1. 待审核视频列表
展示所有待审核的视频：

**列表信息**：
- 视频缩略图
- 患者姓名
- 任务名称（如"上肢功能训练"）
- 上传时间（如"30分钟前"）
- 视频时长
- 优先级标记（紧急视频用红色标记）

**排序规则**：
- 紧急视频优先
- 按上传时间倒序

**筛选功能**：
- 按患者筛选
- 按任务类型筛选
- 按上传时间筛选

#### 2. 视频审核页面
点击视频进入审核页面：

**视频播放器**：
- 支持播放、暂停、快进、后退
- 支持倍速播放（0.5x、1x、1.5x、2x）
- 支持全屏播放
- 显示视频时长和当前播放进度

**患者信息**：
- 患者姓名、年龄
- 诊断信息
- 康复阶段
- 当前康复进度

**任务信息**：
- 任务名称
- 任务要求（时长、动作要点）
- 参考视频（如果有）

**患者说明**：
- 显示患者上传视频时附带的文字说明
- 例如："今天训练时感觉右臂有些酸痛，但能坚持完成"

#### 3. 审核表单
医生填写审核意见：

**审核结果**：
- 通过：训练效果良好，继续保持
- 需改进：存在问题，需要调整

**文字点评**：
- 多行文本输入框
- 医生可以详细描述：
  - 动作是否标准
  - 存在的问题
  - 改进建议
  - 鼓励的话语

**评分（可选）**：
- 五星评分系统
- 评价维度：动作标准度、完成度、努力程度

**建议调整（可选）**：
- 如果需要调整训练强度或频率，可以直接勾选
- 勾选后系统提示医生去调整康复计划

#### 4. 提交审核
- 点击"提交审核"按钮
- 审核结果保存到数据库
- 患者端收到通知："您的训练视频已审核，请查看医生点评"
- 视频状态更新为"已审核"
- 自动跳转到下一个待审核视频（如果有）

#### 5. 审核历史
医生可以查看自己的审核历史：
- 按时间倒序显示
- 显示：患者、任务、审核时间、审核结果
- 点击可以重新查看视频和点评

### 交互优化
- **快捷审核**：对于明显合格的视频，提供"快速通过"按钮，自动填充鼓励语
- **批量操作**：选择多个视频，批量标记为"已查看"（但仍需逐个点评）
- **审核提醒**：超过24小时未审核的视频，系统发送提醒通知

---

## 💬 模块五：患者反馈处理

### 功能定位
处理患者主动发送的反馈和咨询，与患者保持良好沟通，及时解决患者的问题和疑虑。

### 核心功能

#### 1. 反馈列表
展示所有患者反馈：

**反馈卡片信息**：
- 患者姓名
- 反馈类型（疼痛反馈/疑问/进度汇报/其他）
- 反馈内容（显示前两行，超出部分省略）
- 发送时间
- 状态（未读/已读/已回复）
- 优先级标记（紧急反馈用红色左边框）

**排序规则**：
- 紧急反馈优先
- 未读反馈优先
- 按时间倒序

**筛选功能**：
- 按状态筛选（未读/已读/已回复）
- 按患者筛选
- 按反馈类型筛选

#### 2. 反馈详情页
点击反馈进入详情页：

**患者信息**：
- 姓名、年龄、诊断
- 当前康复进度
- 最近训练情况

**反馈内容**：
- 完整的反馈文字
- 发送时间
- 反馈类型

**关联信息（如果有）**：
- 如果反馈关联某个训练任务，显示任务信息
- 如果反馈关联某个视频，显示视频链接

**历史对话**：
- 显示该患者之前的反馈和医生回复
- 方便医生了解上下文

#### 3. 回复反馈
**回复输入框**：
- 多行文本输入框
- 医生输入回复内容

**快捷回复（可选）**：
- 预设常用回复模板
- 例如："这是正常现象，请继续坚持训练"
- 医生可以选择模板后再修改

**操作按钮**：
- 发送回复：回复内容发送给患者
- 标记已读：暂不回复，但标记为已读
- 转为任务：如果需要进一步处理，转为医生任务

#### 4. 回复后处理
- 回复内容保存到数据库
- 反馈状态更新为"已回复"
- 患者端收到通知："医生已回复您的反馈"
- 自动跳转到下一个未读反馈（如果有）

#### 5. 反馈统计
医生可以查看反馈统计：
- 本周收到的反馈数量
- 平均回复时间
- 反馈类型分布
- 紧急反馈处理情况

### 反馈类型说明

#### 疼痛反馈（紧急）
患者反馈训练过程中或训练后的疼痛情况：
- 例如："今天训练后右腿疼痛加剧"
- 医生需要及时回复，判断是否需要调整训练强度

#### 疑问
患者对训练内容、康复进度的疑问：
- 例如："我什么时候可以增加训练强度？"
- 医生给出专业解答

#### 进度汇报
患者主动汇报康复进展：
- 例如："这周感觉进步很大，谢谢医生！"
- 医生给予鼓励和肯定

#### 其他
其他类型的反馈或咨询

---

## 👨‍⚕️ 模块六：医生信息管理

### 功能定位
医生查看和管理自己的个人信息、执业信息和工作统计。

### 核心功能

#### 1. 个人资料卡片
顶部渐变卡片展示：
- 头像（圆形）
- 姓名
- 职称（如"主治医师"）
- 科室（如"康复科"）
- 工号

#### 2. 执业信息
列表形式展示：
- 医师资格证号
- 所属医院
- 职称
- 管理患者数

每项可点击查看详情或编辑

#### 3. 联系方式
- 手机号码
- 电子邮箱

可点击编辑

#### 4. 工作统计
两个统计卡片：
- **本月完成**：本月完成的康复计划数量
- **患者满意度**：综合评分（基于患者反馈）

#### 5. 设置
- 我的报告：查看工作报告
- 系统设置：通知设置、隐私设置等
- 切换账户：退出登录

### UI 对应
`fragment_dt_info_.xml`

---

## 🔔 通知系统

### 通知场景

#### 新患者申请
- 触发：患者输入医生工号申请绑定
- 通知内容："您有新的患者申请，请查看"
- 点击：跳转到患者申请页面

#### 新视频待审核
- 触发：患者上传训练视频
- 通知内容："[患者姓名] 上传了新的训练视频，请审核"
- 点击：跳转到视频审核页面

#### 新反馈待回复
- 触发：患者发送反馈
- 通知内容："[患者姓名] 发送了新的反馈"
- 优先级：紧急反馈显示为高优先级通知
- 点击：跳转到反馈详情页

#### 患者完成任务
- 触发：患者完成今日所有任务
- 通知内容："[患者姓名] 完成了今日所有训练任务"
- 点击：跳转到患者详情页

---

## 📊 数据统计与报表

### 工作台统计
- 管理患者总数
- 待审核视频数量
- 待回复反馈数量
- 今日任务数量

### 患者管理统计
- 患者总数
- 有待审核视频的患者数
- 有新反馈的患者数
- 需要制定计划的患者数

### 工作报告（可选功能）
生成医生的工作报告：
- 时间范围：本周/本月/自定义
- 报告内容：
  - 管理患者数量变化
  - 审核视频数量
  - 回复反馈数量
  - 制定计划数量
  - 患者康复进度统计
  - 患者满意度评分

---

## 🎯 交互流程示例

### 流程1：审核患者视频
```
1. 医生登录，看到工作台显示"3个待审核视频"
2. 点击"审核视频"卡片，进入视频列表
3. 看到第一个视频是"张先生 - 上肢功能训练"，标记为紧急
4. 点击视频，进入审核页面
5. 播放视频，观察患者的训练动作
6. 查看患者说明："今天感觉右臂有些酸痛"
7. 填写点评："动作基本标准，但注意不要过度用力，适当降低强度"
8. 选择"需改进"，评分4星
9. 提交审核
10. 系统提示"审核成功"，自动跳转到下一个视频
```

### 流程2：制定康复计划
```
1. 医生在患者管理页面，点击"张先生"进入详情
2. 点击"制定新计划"按钮
3. 填写计划名称："脑卒中上肢康复计划"
4. 填写康复目标："恢复上肢功能，提升日常生活能力"
5. 设置周期：2024-01-15 至 2024-03-15
6. 点击"添加任务"
7. 添加任务1：上肢功能训练，每天1次，30分钟
8. 添加任务2：手指灵活性训练，每天2次，15分钟
9. 添加任务3：肩关节活动训练，每周3次，20分钟
10. 预览计划，确认无误
11. 点击"激活计划"
12. 系统提示"计划已激活"，患者端立即可见
```

### 流程3：回复患者反馈
```
1. 医生收到通知："李女士发送了新的反馈"
2. 点击通知，进入反馈详情页
3. 看到反馈内容："今天训练后右腿疼痛加剧，是否需要调整强度？"
4. 反馈类型：疼痛反馈（紧急）
5. 查看李女士的最近训练情况和康复进度
6. 填写回复："疼痛加剧需要重视，建议暂时降低训练强度，改为每天1次，时长减少到15分钟。如果疼痛持续，请及时就医。"
7. 勾选"需要调整计划"
8. 点击"发送回复"
9. 系统提示"回复成功"
10. 点击"调整计划"，跳转到计划调整页面
11. 修改"下肢平衡练习"任务：频率改为每天1次，时长改为15分钟
12. 保存调整，患者端收到通知
```

---

**文档结束**





